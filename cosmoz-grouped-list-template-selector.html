<dom-module id="cosmoz-grouped-list-template-selector">
	<template>
		<style>

			[hidden] {
				display: none !important;
			}
		</style>
		<slot></slot>
	</template>
</dom-module>

<script>
	/*global Polymer*/
	'use strict';
	Polymer({

		is: 'cosmoz-grouped-list-template-selector',

		properties: {
			item: {
				type: Object,
				observer: '_itemChanged'
			},

			selectorId: {
				type: Number,
			},

			template: {
				type: Object
			},

			templateInstance: {
				type: Object
			},

			element: {
				type: Object
			},

			slotName: {
				type: String
			}
		},

		_itemChanged: function (newItem) {
			var slot;

			if (this.selectorId === undefined) {
				// Notifies parent cosmoz-grouped-list that a new template-selector
				// has been added so that it gets a selectorId
				this.fire('template-selector-created', {
					selector: this
				}, {
					bubbles: false
				});

				this.slotName = 'selectorSlot' + this.selectorId;
				slot = Polymer.dom(this).querySelector('slot');
				if (slot !== null) {
					slot.setAttribute('name', this.slotName);
				} else {
					slot = Polymer.dom(this).querySelector('content');
					slot.setAttribute('select', '[slot="' + this.slotName + '"]');
					slot.setAttribute('name', this.slotName);
				}
			}

			this.fire('template-selector-item-changed', {
				selector: this,
				item: newItem,
			}, {
				bubbles: false
			});
		},
	});
</script>
